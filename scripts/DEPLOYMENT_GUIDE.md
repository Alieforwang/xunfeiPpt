# è®¯é£æ™ºæ–‡PPTæœåŠ¡ - è·¨å¹³å°è‡ªåŠ¨éƒ¨ç½²æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ¡ˆä¸€ï¼šä¸€é”®ç®€åŒ–éƒ¨ç½² (æ¨èæ–°æ‰‹)

é€‚ç”¨äºå¿«é€Ÿæµ‹è¯•å’Œç®€å•éƒ¨ç½²åœºæ™¯ï¼š

```bash
# ä¸‹è½½å¹¶è¿è¡Œç®€åŒ–éƒ¨ç½²è„šæœ¬
curl -o quick_deploy.sh https://your-server/quick_deploy.sh
bash quick_deploy.sh
```

æˆ–è€…ç›´æ¥å¤åˆ¶ç²˜è´´è„šæœ¬å†…å®¹åè¿è¡Œã€‚

### æ–¹æ¡ˆäºŒï¼šå®Œæ•´è‡ªåŠ¨éƒ¨ç½² (æ¨èç”Ÿäº§ç¯å¢ƒ)

æ”¯æŒè·¨å¹³å°è‡ªåŠ¨é€‚é…ï¼ŒåŒ…å«å®Œæ•´çš„ç³»ç»Ÿæ£€æµ‹å’ŒæœåŠ¡ç®¡ç†ï¼š

```bash
# ä¸‹è½½å¹¶è¿è¡Œå®Œæ•´éƒ¨ç½²è„šæœ¬
curl -o auto_deploy.sh https://your-server/auto_deploy.sh
bash auto_deploy.sh
```

## ğŸ”§ è·¨å¹³å°æ”¯æŒ

### è‡ªåŠ¨æ£€æµ‹åŠŸèƒ½

éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹ä»¥ä¸‹ç³»ç»Ÿç¯å¢ƒï¼š

- **æ“ä½œç³»ç»Ÿ**: Linux, macOS, Windows (Cygwin/MSYS)
- **Linuxå‘è¡Œç‰ˆ**: Ubuntu, CentOS, Debian ç­‰
- **Pythonç‰ˆæœ¬**: è‡ªåŠ¨é€‰æ‹© python3 æˆ– python
- **åŒ…ç®¡ç†å™¨**: ä¼˜å…ˆä½¿ç”¨ uvï¼Œå›é€€åˆ° pip
- **æ–‡ä»¶ç¼–ç **: è‡ªåŠ¨è½¬æ¢ Windows CRLF åˆ° Unix LF

### ç³»ç»Ÿç‰¹å®šé…ç½®

| ç³»ç»Ÿ | å·¥ä½œç›®å½• | æœåŠ¡ç®¡ç† | ç«¯å£é…ç½® |
|------|----------|----------|----------|
| Linux | `/www/wwwroot/xunfeiPpt` | systemd æˆ–é€šç”¨è„šæœ¬ | 60 |
| macOS | `~/xunfeiPpt` | é€šç”¨è„šæœ¬ | 60 |
| Windows | `/c/xunfeiPpt` | é€šç”¨è„šæœ¬ | 60 |

## ğŸ“‹ éƒ¨ç½²è„šæœ¬è¯´æ˜

### auto_deploy.sh (å®Œæ•´ç‰ˆ)

åŠŸèƒ½ç‰¹æ€§ï¼š
- âœ… è·¨å¹³å°ç³»ç»Ÿæ£€æµ‹
- âœ… è‡ªåŠ¨æ–‡ä»¶ç¼–ç è½¬æ¢
- âœ… Pythonç¯å¢ƒæ™ºèƒ½é€‚é…
- âœ… ä¾èµ–è‡ªåŠ¨å®‰è£…
- âœ… systemdæœåŠ¡é…ç½® (Linux)
- âœ… é€šç”¨æœåŠ¡ç®¡ç†è„šæœ¬
- âœ… æœåŠ¡çŠ¶æ€æ£€æµ‹
- âœ… å½©è‰²æ—¥å¿—è¾“å‡º
- âœ… é”™è¯¯å¤„ç†å’Œæ¢å¤

ä½¿ç”¨åœºæ™¯ï¼š
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- éœ€è¦systemdæœåŠ¡ç®¡ç†
- å¤šå¹³å°æ”¯æŒéœ€æ±‚
- å¤æ‚ç¯å¢ƒé…ç½®

### quick_deploy.sh (ç®€åŒ–ç‰ˆ)

åŠŸèƒ½ç‰¹æ€§ï¼š
- âœ… å¿«é€Ÿä¸€é”®éƒ¨ç½²
- âœ… åŸºç¡€ç¯å¢ƒæ£€æµ‹
- âœ… ç®€åŒ–ç‰ˆMCPæœåŠ¡å™¨
- âœ… åŸºæœ¬æœåŠ¡ç®¡ç†
- âœ… æœ€å°ä¾èµ–éœ€æ±‚

ä½¿ç”¨åœºæ™¯ï¼š
- å¿«é€Ÿæµ‹è¯•
- å¼€å‘ç¯å¢ƒ
- å­¦ä¹ å’Œæ¼”ç¤º
- ç®€å•éƒ¨ç½²éœ€æ±‚

## ğŸ› ï¸ æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

å¦‚æœè‡ªåŠ¨éƒ¨ç½²é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨éƒ¨ç½²ï¼š

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# åˆ›å»ºå·¥ä½œç›®å½•
mkdir -p /www/wwwroot/xunfeiPpt
cd /www/wwwroot/xunfeiPpt

# æ£€æŸ¥Pythonç¯å¢ƒ
python3 --version || python --version
```

### 2. å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨pipå®‰è£…
pip3 install mcp requests requests-toolbelt starlette uvicorn

# æˆ–ä½¿ç”¨uvå®‰è£…ï¼ˆå¦‚æœå¯ç”¨ï¼‰
uv pip install mcp requests requests-toolbelt starlette uvicorn
```

### 3. åˆ›å»ºmain.py

å¤åˆ¶å®Œæ•´çš„main.pyæ–‡ä»¶å†…å®¹ï¼Œæˆ–ä»ä»“åº“ä¸‹è½½ã€‚

### 4. å¯åŠ¨æœåŠ¡

```bash
# ç›´æ¥å¯åŠ¨
python3 main.py sse --host 0.0.0.0 --port 60

# åå°å¯åŠ¨
nohup python3 main.py sse --host 0.0.0.0 --port 60 > service.log 2>&1 &
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ–‡ä»¶ç¼–ç é—®é¢˜

**ç—‡çŠ¶**: `line 2: $'\r': command not found`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨dos2unixè½¬æ¢
dos2unix deploy.sh

# æˆ–ä½¿ç”¨sedè½¬æ¢
sed -i 's/\r$//' deploy.sh

# æˆ–ä½¿ç”¨trè½¬æ¢
tr -d '\r' < deploy.sh > deploy_fixed.sh
```

#### 2. Pythonç‰ˆæœ¬é—®é¢˜

**ç—‡çŠ¶**: è¯­æ³•é”™è¯¯æˆ–æ¨¡å—ç¼ºå¤±

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬
python3 --version

# å¦‚æœæ˜¯æ—§ç‰ˆæœ¬Pythonï¼Œéœ€è¦ä¿®æ”¹f-stringè¯­æ³•
# è„šæœ¬ä¼šè‡ªåŠ¨å¤„ç†ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æ›¿æ¢ï¼š
# f"text {var}" -> "text {}".format(var)
```

#### 3. ç«¯å£è¢«å ç”¨

**ç—‡çŠ¶**: ç«¯å£60å·²è¢«ä½¿ç”¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep 60
sudo ss -tlnp | grep 60

# åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹æˆ–æ›´æ¢ç«¯å£
python3 main.py sse --host 0.0.0.0 --port 8060
```

#### 4. æƒé™é—®é¢˜

**ç—‡çŠ¶**: æ— æ³•åˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x auto_deploy.sh
chmod +x quick_deploy.sh

# ä½¿ç”¨sudoè¿è¡Œï¼ˆå¦‚æœéœ€è¦ï¼‰
sudo bash auto_deploy.sh
```

### æœåŠ¡ç®¡ç†

#### Linux systemdæœåŠ¡

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status ppt-mcp-sse

# å¯åŠ¨/åœæ­¢/é‡å¯æœåŠ¡
sudo systemctl start ppt-mcp-sse
sudo systemctl stop ppt-mcp-sse
sudo systemctl restart ppt-mcp-sse

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
journalctl -u ppt-mcp-sse -f
```

#### é€šç”¨æœåŠ¡ç®¡ç†

```bash
# ä½¿ç”¨æœåŠ¡ç®¡ç†è„šæœ¬
bash service_manager.sh start
bash service_manager.sh stop
bash service_manager.sh restart
bash service_manager.sh status

# æˆ–ä½¿ç”¨ç®€åŒ–ç‰ˆè„šæœ¬
bash service.sh start
bash service.sh stop
bash service.sh status
```

## ğŸŒ ç½‘ç»œé…ç½®

### é˜²ç«å¢™è®¾ç½®

#### Linux (firewalld)
```bash
sudo firewall-cmd --permanent --add-port=60/tcp
sudo firewall-cmd --reload
```

#### Linux (ufw)
```bash
sudo ufw allow 60
```

#### æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€
```bash
# firewalld
sudo firewall-cmd --list-ports

# ufw
sudo ufw status
```

### è®¿é—®åœ°å€

éƒ¨ç½²æˆåŠŸåï¼Œå¯é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®æœåŠ¡ï¼š

- **æœ¬åœ°è®¿é—®**: http://localhost:60
- **å±€åŸŸç½‘è®¿é—®**: http://å†…ç½‘IP:60
- **å…¬ç½‘è®¿é—®**: http://å…¬ç½‘IP:60 (éœ€é…ç½®é˜²ç«å¢™)

### çŠ¶æ€é¡µé¢

è®¿é—®æ ¹è·¯å¾„å¯çœ‹åˆ°æœåŠ¡çŠ¶æ€é¡µé¢ï¼š
- æœåŠ¡è¿è¡ŒçŠ¶æ€
- å¯ç”¨å·¥å…·åˆ—è¡¨
- SSEè¿æ¥æµ‹è¯•
- ä½¿ç”¨è¯´æ˜

## ğŸ“Š æ€§èƒ½ç›‘æ§

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—

```bash
# systemdæœåŠ¡æ—¥å¿—
journalctl -u ppt-mcp-sse -f

# ç›´æ¥å¯åŠ¨çš„æœåŠ¡æ—¥å¿—
tail -f /www/wwwroot/xunfeiPpt/service.log
```

### APIå¯†é’¥æ± çŠ¶æ€

å¯é€šè¿‡MCPå·¥å…·æŸ¥çœ‹å¯†é’¥æ± ä½¿ç”¨æƒ…å†µï¼š
- æ€»å¯†é’¥æ•°é‡
- æ´»è·ƒå¯†é’¥æ•°é‡
- å¹¶å‘ä½¿ç”¨æƒ…å†µ
- é”™è¯¯ç‡ç»Ÿè®¡

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### æ›´æ–°æœåŠ¡

```bash
# åœæ­¢æœåŠ¡
bash service_manager.sh stop

# æ›´æ–°ä»£ç 
# å¤åˆ¶æ–°çš„main.pyæ–‡ä»¶

# é‡å¯æœåŠ¡
bash service_manager.sh start
```

### å¤‡ä»½é…ç½®

```bash
# å¤‡ä»½å·¥ä½œç›®å½•
tar -czf ppt-mcp-backup-$(date +%Y%m%d).tar.gz /www/wwwroot/xunfeiPpt
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°éƒ¨ç½²é—®é¢˜ï¼š

1. æ£€æŸ¥ç³»ç»Ÿå…¼å®¹æ€§
2. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
3. ä½¿ç”¨è¯Šæ–­è„šæœ¬
4. æŸ¥é˜…æ•…éšœæ’é™¤æŒ‡å—
5. è”ç³»æŠ€æœ¯æ”¯æŒ

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0 - è·¨å¹³å°è‡ªåŠ¨éƒ¨ç½²
- âœ… æ–°å¢è·¨å¹³å°è‡ªåŠ¨æ£€æµ‹
- âœ… æ–°å¢æ–‡ä»¶ç¼–ç è‡ªåŠ¨è½¬æ¢
- âœ… æ–°å¢Pythonç¯å¢ƒæ™ºèƒ½é€‚é…
- âœ… æ–°å¢ç®€åŒ–éƒ¨ç½²è„šæœ¬
- âœ… æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ¢å¤
- âœ… æ–°å¢å½©è‰²æ—¥å¿—è¾“å‡º

### v1.0 - åŸºç¡€éƒ¨ç½²
- âœ… Linux systemdæœåŠ¡æ”¯æŒ
- âœ… åŸºç¡€MCPæœåŠ¡å™¨åŠŸèƒ½
- âœ… APIå¯†é’¥æ± ç®¡ç†
- âœ… SSEä¼ è¾“åè®®æ”¯æŒ
